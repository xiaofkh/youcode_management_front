# 开发指南

## 项目目录结构

```
src/
├── components/          # 通用组件
│   ├── ui/             # 基础 UI 组件 (Button, Input, Dialog 等)
│   └── layout/         # 布局组件 (Header, Sidebar, Layout 等)
├── pages/              # 页面组件 (按功能模块划分)
│   └── home/           # 示例: 首页模块
│       ├── HomePage.tsx
│       ├── components/ # 页面私有组件
│       └── hooks/      # 页面私有 hooks
├── hooks/              # 全局自定义 hooks
├── lib/                # 工具函数和配置
│   ├── api.ts          # Axios 实例和拦截器
│   └── utils.ts        # 通用工具函数
├── store/              # Jotai 状态管理 (按需创建)
├── types/              # TypeScript 类型定义 (按需创建)
├── styles/             # 全局样式
│   └── index.css       # Tailwind 入口和 CSS 变量
├── App.tsx             # 根组件和路由配置
└── main.tsx            # 应用入口
```

## 页面开发

### 1. 创建新页面

在 `src/pages/` 下创建模块目录:

```
src/pages/users/
├── UsersPage.tsx       # 页面主组件
├── components/         # 页面私有组件
│   └── UserTable.tsx
└── hooks/              # 页面私有 hooks
    └── useUsers.ts
```

### 2. 注册路由

在 `src/App.tsx` 中添加路由:

```tsx
import { UsersPage } from "@/pages/users/UsersPage"

<Routes>
  <Route path="/" element={<Layout />}>
    <Route index element={<HomePage />} />
    <Route path="users" element={<UsersPage />} />
  </Route>
</Routes>
```

### 3. 页面组件示例

```tsx
// src/pages/users/UsersPage.tsx
import { useUsers } from "./hooks/useUsers"
import { UserTable } from "./components/UserTable"

export function UsersPage() {
  const { data, isLoading } = useUsers()

  if (isLoading) return <div>加载中...</div>

  return (
    <div>
      <h2 className="text-2xl font-bold mb-4">用户管理</h2>
      <UserTable data={data} />
    </div>
  )
}
```

## API 调用

### 方式一: 使用封装的 hooks (推荐)

```tsx
// src/pages/users/hooks/useUsers.ts
import { useGet, usePost } from "@/hooks/useApi"

interface User {
  id: number
  name: string
}

// GET 请求
export function useUsers() {
  return useGet<User[]>(["users"], "/users")
}

// POST 请求
export function useCreateUser() {
  return usePost<User, { name: string }>("/users")
}
```

使用:

```tsx
function UsersPage() {
  const { data, isLoading, error } = useUsers()
  const createUser = useCreateUser()

  const handleCreate = () => {
    createUser.mutate({ name: "新用户" })
  }
}
```

### 方式二: 直接使用 React Query

```tsx
import { useQuery, useMutation } from "@tanstack/react-query"
import { api } from "@/lib/api"

function useUsers() {
  return useQuery({
    queryKey: ["users"],
    queryFn: () => api.get("/users"),
  })
}
```

### 方式三: 直接使用 Axios

```tsx
import { api } from "@/lib/api"

async function fetchUsers() {
  const data = await api.get("/users")
  return data
}
```

## UI 组件使用

### 基础组件

项目已配置 Radix UI + Tailwind 的组件模式，参考 `src/components/ui/button.tsx`:

```tsx
import { Button } from "@/components/ui/button"

<Button variant="default">默认按钮</Button>
<Button variant="outline">边框按钮</Button>
<Button variant="destructive">危险按钮</Button>
```

### 添加新组件

可从 [shadcn/ui](https://ui.shadcn.com/) 复制组件代码到 `src/components/ui/`，组件基于相同的技术栈。

## 状态管理

### 局部状态

使用 React 内置的 `useState`:

```tsx
const [count, setCount] = useState(0)
```

### 全局状态 (Jotai)

```tsx
// src/store/user.ts
import { atom, useAtom } from "jotai"

export const userAtom = atom<User | null>(null)

// 使用
function Header() {
  const [user, setUser] = useAtom(userAtom)
}
```

## 样式开发

使用 Tailwind CSS 类名:

```tsx
<div className="flex items-center gap-4 p-4 bg-white rounded-lg shadow">
  <span className="text-lg font-medium text-gray-900">标题</span>
</div>
```

CSS 变量定义在 `src/styles/index.css`，可自定义主题色。

## 类型定义

```tsx
// src/types/user.ts
export interface User {
  id: number
  name: string
  email: string
}

// src/types/api.ts
export interface ApiResponse<T> {
  code: number
  data: T
  message: string
}
```
